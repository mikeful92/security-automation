import unittest
from unittest.mock import patch
import examples.vulnerability_scanner as scanner

class TestVulnerabilityScanner(unittest.TestCase):

    @patch("examples.vulnerability_scanner.requests.get")
    def test_missing_headers(self, mock_get):
        mock_get.return_value.headers = {
            "Content-Security-Policy": "default-src 'self'",
            "X-Frame-Options": "DENY"
        }
        missing = scanner.check_security_headers("http://google.com")
        self.assertIn("X-XSS-Protection", missing)
        self.assertIn("Strict-Transport-Security", missing)

if __name__ == "__main__":
    unittest.main()